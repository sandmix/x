<!DOCTYPE html>
<html>
<body>

<h2>Math Practice</h2>
<div id="worksheet"></div>

<script>
const COLS = 4;
const EX_PER_COL = 28;

const worksheet = document.getElementById("worksheet");

function formatTime(ms){
 const s=Math.floor(ms/1000);
 return String(Math.floor(s/60)).padStart(2,'0')+":"+String(s%60).padStart(2,'0');
}

function generateExercise(){
 const ops=["+","-","×","÷"];
 const op=ops[Math.floor(Math.random()*ops.length)];
 let a,b,r;

 if(op==="+"||op==="-"){
  a=Math.floor(Math.random()*90)+10;
  b=Math.floor(Math.random()*90)+1;
  if(op==="-"&&b>a)[a,b]=[b,a];
  r=op==="+"?a+b:a-b;
 }else{
  b=Math.floor(Math.random()*5)+1;
  a=Math.floor(Math.random()*10)+1;
  if(op==="÷")a*=b;
  r=op==="×"?a*b:a/b;
 }

 return {a,b,op,r};
}

for(let c=0;c<COLS;c++){

 const colDiv=document.createElement("div");
 colDiv.className="column";

 colDiv.innerHTML=`
 <h3>Column ${c+1}</h3>
 <div class="timer">Time: 00:00</div>
 `;

 const timerDiv=colDiv.querySelector(".timer");

 let startTime=null;
 let interval=null;

 function startTimer(){
  if(startTime!==null)return;
  startTime=Date.now();
  interval=setInterval(()=>{
   timerDiv.textContent="Time: "+formatTime(Date.now()-startTime);
  },500);
 }

 for(let i=0;i<EX_PER_COL;i++){

  const ex=generateExercise();
  let attempts=0;

  const exDiv=document.createElement("div");
  exDiv.className="exercise";

  exDiv.innerHTML=`
   <span>${ex.a}</span>
   <span>${ex.op}</span>
   <span>${ex.b}</span>
   <span>=</span>
   <input type="number">
  `;

  const input=exDiv.querySelector("input");

  input.addEventListener("input",()=>{

   if(input.value==="")return;

   startTimer(); // timer starts ONLY after first data entry

   const val=Number(input.value);

   if(val===ex.r){
    input.className="correct";
    input.disabled=true;
   }else{
    attempts++;
    input.className="wrong";

    if(attempts>=3){
     input.disabled=true;
    }
   }
  });

  colDiv.appendChild(exDiv);
 }

 worksheet.appendChild(colDiv);
}
</script>


</body>
</html>

